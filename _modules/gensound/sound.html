<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>gensound.sound &#8212; PyGenSound 0.0.1 dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1 dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for gensound.sound</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; The module of Sound class for handling sound &quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pyaudio</span>
<span class="kn">import</span> <span class="nn">soundfile</span>

<span class="kn">from</span> <span class="nn">gensound.exceptions</span> <span class="k">import</span> <span class="o">*</span>


<span class="k">def</span> <span class="nf">_repeat_array</span><span class="p">(</span><span class="n">sound</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">want_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Repeat numpy.array for enlarging a sound duration</span>

<span class="sd">    :param sound:       Sound data for repeat.</span>
<span class="sd">    :param want_length: The length of an output array.</span>

<span class="sd">    :return: Repeated sound data.</span>

<span class="sd">    :exception ValueError:</span>


<span class="sd">    &gt;&gt;&gt; array = numpy.array([[1, 2, 3]]).T</span>
<span class="sd">    &gt;&gt;&gt; numpy.allclose(_repeat_array(array, 6),</span>
<span class="sd">    ...                numpy.array([[1, 2, 3, 1, 2, 3]]).T)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; numpy.allclose(_repeat_array(array, 8),</span>
<span class="sd">    ...                numpy.array([[1, 2, 3, 1, 2, 3, 1, 2]]).T)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; numpy.allclose(_repeat_array(array, 2), numpy.array([[1, 2]]).T)</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">want_length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;want_length must be greater than 0 but got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">want_length</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;sound should two dimensions&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;sound should have least one element&#39;</span><span class="p">)</span>

    <span class="n">need_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">want_length</span> <span class="o">/</span> <span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">drop_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">need_length</span> <span class="o">*</span> <span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">want_length</span><span class="p">)</span>

    <span class="n">repeated</span> <span class="o">=</span> <span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">T</span>
                <span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">])</span>
                <span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">need_length</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">drop_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">repeated</span><span class="p">[:</span><span class="o">-</span><span class="n">drop_length</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">repeated</span>


<span class="k">def</span> <span class="nf">_assertFrequency</span><span class="p">(</span><span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if the frequency is greater than 0 &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFrequencyError</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if the samplerate is greater than 0 &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">samplerate</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidSamplerateError</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_assertSameSamplerate</span><span class="p">(</span><span class="n">samplerates</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if all samplerates is same value &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">samplerates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samplerates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">raise</span> <span class="n">DifferentSamplerateError</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">samplerates</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_assertSameChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if all number of channels is same value &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">raise</span> <span class="n">DifferentChannelsError</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">channels</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if the duration is longer than 0 &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">duration</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidDurationError</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_assertVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if the volume in between 0.0 to 1.0 &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">volume</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="mf">1.0</span> <span class="o">&lt;</span> <span class="n">volume</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidVolumeError</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>


<div class="viewcode-block" id="Sound"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound">[docs]</a><span class="k">class</span> <span class="nc">Sound</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; The class for handling sound</span>

<span class="sd">    :param data:       Sound data array. First dimension is time, second</span>
<span class="sd">                       dimension is channel. Will clipping if value were out of</span>
<span class="sd">                       -1.0 to 1.0.</span>
<span class="sd">    :param samplerate: Sampling rate of sound data.</span>

<span class="sd">    :exception ValueError:             Data was invalid dimensions.</span>
<span class="sd">    :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">    :exception InvalidDurationError:   Data was empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data dimensions must be 1 or 2 but got </span><span class="si">{}</span><span class="s1">&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>
        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_samplerate</span> <span class="o">=</span> <span class="n">samplerate</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_sinwave"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_sinwave">[docs]</a>    <span class="k">def</span> <span class="nf">from_sinwave</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                     <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                     <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                     <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">,</span>
                     <span class="n">smooth_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Generate sine wave sound</span>

<span class="sd">        :param frequency:  Frequency of new sound.</span>
<span class="sd">        :param duration:   Duration in seconds of new sound.</span>
<span class="sd">        :param volume:     The volume of new sound.</span>
<span class="sd">        :param samplerate: Sampling rate of new sound.</span>
<span class="sd">        :param smooth_end: Do make smooth end or not. Please see above.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>

<span class="sd">        :exception InvalidDurationError:   Duration was 0 or less.</span>
<span class="sd">        :exception InvalidFrequencyError:  Frequency was 0 or less.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">        :exception InvalidVolumeError:     Volume was lower than 0.0 or higher</span>
<span class="sd">                                           than 1.0.</span>


<span class="sd">        This example makes 440Hz sine wave sound.</span>

<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(440)</span>

<span class="sd">        Can set duration and volume with arguments.</span>
<span class="sd">        This example makes 2 seconds, 50% volume.</span>

<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(440, duration=2.0, volume=0.5)</span>

<span class="sd">        Can make 2 seconds sine wave with repeat too. But, this way may make</span>
<span class="sd">        noise at the joint point of sounds.</span>
<span class="sd">        Recommend using from_sinwave() as possible.</span>


<span class="sd">        Make a smooth end if smooth_end is true. but duration will inaccuracy.</span>
<span class="sd">        This error is not critical most cases so smooth_end is true by default.</span>

<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(880, duration=1.0, smooth_end=True)</span>
<span class="sd">        &gt;&gt;&gt; sound.duration</span>
<span class="sd">        1.017687074829932</span>

<span class="sd">        Please pass false to smooth_end if want accurate duration. But please</span>
<span class="sd">        be careful, may make noise in end of sound if disable smooth_end.</span>

<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(880, duration=1.0, smooth_end=False)</span>
<span class="sd">        &gt;&gt;&gt; sound.duration</span>
<span class="sd">        1.0</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">_assertFrequency</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>
        <span class="n">_assertVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>

        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">samplerate</span> <span class="o">/</span> <span class="n">frequency</span>

        <span class="n">one_wave</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span> <span class="o">/</span> <span class="n">wavelength</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">volume</span>

        <span class="n">repeat_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">samplerate</span> <span class="o">/</span> <span class="n">wavelength</span><span class="p">))</span>
        <span class="n">repeated</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">one_wave</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                <span class="n">repeat_count</span><span class="p">,</span>
                                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">smooth_end</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">repeated</span> <span class="o">=</span> <span class="n">repeated</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">samplerate</span><span class="p">))]</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">repeated</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_sawtoothwave"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_sawtoothwave">[docs]</a>    <span class="k">def</span> <span class="nf">from_sawtoothwave</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                          <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                          <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                          <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Generate sawtooth wave sound</span>

<span class="sd">        :param frequency:  Frequency of new sound.</span>
<span class="sd">        :param duration:   Duration in seconds of new sound.</span>
<span class="sd">        :param volume:     The volume of new sound.</span>
<span class="sd">        :param samplerate: Sampling rate of new sound.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>

<span class="sd">        :exception InvalidDurationError:   Duration was 0 or less.</span>
<span class="sd">        :exception InvalidFrequencyError:  Frequency was 0 or less.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">        :exception InvalidVolumeError:     Volume was lower than 0.0 or higher</span>
<span class="sd">                                           than 1.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">_assertFrequency</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>
        <span class="n">_assertVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>

        <span class="n">count</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">samplerate</span><span class="p">)</span> <span class="o">*</span> <span class="n">frequency</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">1</span>
        <span class="n">data</span> <span class="o">/=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">((</span><span class="n">data</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">volume</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_squarewave"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_squarewave">[docs]</a>    <span class="k">def</span> <span class="nf">from_squarewave</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                        <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Generate square wave sound</span>

<span class="sd">        :param frequency:  Frequency of new sound.</span>
<span class="sd">        :param duration:   Duration in seconds of new sound.</span>
<span class="sd">        :param volume:     The volume of new sound.</span>
<span class="sd">        :param samplerate: Sampling rate of new sound.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>

<span class="sd">        :exception InvalidDurationError:   Duration was 0 or less.</span>
<span class="sd">        :exception InvalidFrequencyError:  Frequency was 0 or less.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">        :exception InvalidVolumeError:     Volume was lower than 0.0 or higher</span>
<span class="sd">                                           than 1.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">_assertFrequency</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>
        <span class="n">_assertVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">samplerate</span> <span class="o">/</span> <span class="n">frequency</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))),</span>
            <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">samplerate</span> <span class="o">/</span> <span class="n">frequency</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))),</span>
        <span class="p">])</span> <span class="o">*</span> <span class="n">volume</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.silence"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.silence">[docs]</a>    <span class="k">def</span> <span class="nf">silence</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Generate silent sound</span>

<span class="sd">        :duration:   Duration of new sound.</span>
<span class="sd">        :samplerate: Sampling rate of new sound.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>

<span class="sd">        :exception InvalidDurationError:   Duration was 0 or less.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>

        <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">samplerate</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">length</span><span class="p">),</span> <span class="n">samplerate</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_whitenoise"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_whitenoise">[docs]</a>    <span class="k">def</span> <span class="nf">from_whitenoise</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                        <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Generate white noise</span>

<span class="sd">        :param duration:   Duration in seconds of new sound.</span>
<span class="sd">        :param volume:     The volume of new sound.</span>
<span class="sd">        :param samplerate: Sampling rate of new sound.</span>

<span class="sd">        :return: A new Sound instance.</span>

<span class="sd">        :exception InvalidDurationError:   Duration was 0 or less.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">        :exception InvalidVolumeError:     Volume was lower than 0.0 or higher</span>
<span class="sd">                                           than 1.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>
        <span class="n">_assertVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>

        <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">samplerate</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">*</span> <span class="n">volume</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_file"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_file">[docs]</a>    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">BinaryIO</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Read sound from file or file-like</span>

<span class="sd">        :param file_: File name or file-like object.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span><span class="p">,</span> <span class="n">samplerate</span> <span class="o">=</span> <span class="n">soundfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file_</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">/=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_array"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_array">[docs]</a>    <span class="k">def</span> <span class="nf">from_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                   <span class="n">array</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                   <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Make new sound from float array</span>

<span class="sd">        :param array:      Sound data. Elements must in between -1.0 to 1.0.</span>
<span class="sd">        :param samplerate: Sampling rate of new sound.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>

<span class="sd">        :exception InvalidDurationError:   The array was empty.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>


<span class="sd">        This method is same as passing numpy.array to the Sound constructor.</span>

<span class="sd">        &gt;&gt;&gt; (Sound.from_array([-0.1, 0.0, 1.0], 3)</span>
<span class="sd">        ...  == Sound(numpy.array([-0.1, 0.0, 1.0]), 3))</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">samplerate</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Sound.from_fft"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.from_fft">[docs]</a>    <span class="k">def</span> <span class="nf">from_fft</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                 <span class="n">spectrum</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
                 <span class="n">samplerate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Make new sound from spectrum data like a result from fft() method.</span>

<span class="sd">        :param spectrum:   A spectrum data. Please see fft() method about a</span>
<span class="sd">                           format.</span>
<span class="sd">        :param samplerate: Sampling rate of new sound. Use spectrum data if</span>
<span class="sd">                           None.</span>

<span class="sd">        :return: A new :class:`Sound` instance.</span>

<span class="sd">        :exception InvalidDurationError:   Duration was 0 or less.</span>
<span class="sd">        :exception InvalidSamplerateError: Samplerate was 0 or less.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">samplerate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">samplerate</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">_assertSamplerate</span><span class="p">(</span><span class="n">samplerate</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">spectrum</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">samplerate</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Duration in seconds of this sound &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">samplerate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Sampling rate of this sound &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_samplerate</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Number of channels &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Volume of this dound</span>

<span class="sd">        This volume means the maximum value of the wave.</span>
<span class="sd">        Please be careful that is not gain.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Raw data of sound</span>

<span class="sd">        This array is two dimensions. The first dimension means time, and the</span>
<span class="sd">        second dimension means channels.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">another</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Compare with another Sound instance &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">another</span><span class="p">,</span> <span class="n">Sound</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span> <span class="o">==</span> <span class="n">another</span><span class="o">.</span><span class="n">samplerate</span>
                <span class="ow">and</span> <span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">another</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">another</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">another</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">slice</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Slice a sound</span>

<span class="sd">        :param position: A position in seconds in float or slice.</span>

<span class="sd">        :return: A new :class:`Sound` instance that sliced.</span>

<span class="sd">        :exception ValueError: Passed slice had step value.</span>


<span class="sd">        If passed float a position, returns very short sound that only has</span>
<span class="sd">        1/samplerate seconds.</span>

<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(440)</span>

<span class="sd">        &gt;&gt;&gt; short_sound = sound[0.5]</span>
<span class="sd">        &gt;&gt;&gt; short_sound.duration == 1 / sound.samplerate</span>
<span class="sd">        True</span>


<span class="sd">        The step of the slice is not supported. Will raise ValueError if passed</span>
<span class="sd">        slice that has a step.</span>

<span class="sd">        &gt;&gt;&gt; sound[::1]</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: step is not supported</span>


<span class="sd">        :class:`Trim effect&lt;gensound.effect.Trim&gt;` has the same function this.</span>
<span class="sd">        You can use :class:`&lt;Trim effect&lt;gensound.effect.Trim&gt;` when process</span>
<span class="sd">        many sounds by :class:`JoinedEffect&lt;gensound.effect.JoinedEffect&gt;`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">&lt;</span> <span class="n">position</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">OutOfDurationError</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">position</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;step is not supported&#39;</span><span class="p">)</span>

            <span class="n">start</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">start</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">start</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">))</span>

            <span class="n">stop</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">stop</span>
            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">stop</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">))</span>

            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">,</span> <span class="p">:]</span>

        <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span>

<div class="viewcode-block" id="Sound.split_channels"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.split_channels">[docs]</a>    <span class="k">def</span> <span class="nf">split_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot; Split channels into Sound</span>

<span class="sd">        :return: A list of :class:`Sound` instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Sound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="Sound.as_monaural"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.as_monaural">[docs]</a>    <span class="k">def</span> <span class="nf">as_monaural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Create a new instance that converted to monaural sound</span>

<span class="sd">        :return: A :class:`Sound` instance that monaural.</span>


<span class="sd">        If an instance already monaural sound, may returns the same instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sound.as_stereo"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.as_stereo">[docs]</a>    <span class="k">def</span> <span class="nf">as_stereo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Create a new instance that converted to multi channel sound</span>

<span class="sd">        :return: A new :class:`Sound` instance that stereo or multi channel.</span>

<span class="sd">        :exception ValueError: A given channels were lesser than a number of</span>
<span class="sd">                               channels of this sound.</span>


<span class="sd">        This method will return the same instance if this sound already had the</span>
<span class="sd">        same number of channels.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">==</span> <span class="n">channels</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">&gt;</span> <span class="n">channels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;channels must be </span><span class="si">{}</span><span class="s1"> or greater but got </span><span class="si">{}</span><span class="s1">&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">channels</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sound.fft"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.fft">[docs]</a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Calculate fft</span>

<span class="sd">        :return: An array that pair of frequency and value.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">freqs</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span>
                <span class="n">freqs</span><span class="p">,</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="n">channel</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="p">])</span>
            <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="p">])</span></div>

<div class="viewcode-block" id="Sound.repeat"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.repeat">[docs]</a>    <span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Create a new instance that repeated same sound</span>

<span class="sd">        :param duration: Duration in seconds to repeat.</span>

<span class="sd">        :return: A new :class:`Sound` instance that repeated same sound.</span>

<span class="sd">        :exception InvalidDurationError: Duration was shorter than 0.</span>


<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(440)</span>
<span class="sd">        &gt;&gt;&gt; sound.repeat(5).duration</span>
<span class="sd">        5.0</span>

<span class="sd">        This function can not only repeat but trimming.</span>
<span class="sd">        But recommend use slice because become hard to understand if using it</span>
<span class="sd">        for trimming.</span>

<span class="sd">        &gt;&gt;&gt; sound.repeat(0.5).duration</span>
<span class="sd">        0.5</span>
<span class="sd">        &gt;&gt;&gt; sound.repeat(0.5) == sound[:0.5]</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_assertDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span>
            <span class="n">_repeat_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                          <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">))),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Sound.concat"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.concat">[docs]</a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">another</span><span class="p">:</span> <span class="s1">&#39;Sound&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Create a new instance that concatenated another sound</span>

<span class="sd">        :param another: The sound that concatenates after of self.</span>
<span class="sd">                        Must it has same sampling rate.</span>

<span class="sd">        :return: A new :class:`Sound` that concatenated self and other.</span>

<span class="sd">        :exception DifferentSamplerateError: The samplerate was different.</span>
<span class="sd">        :exception DifferentChannelsError:   The number of channels was</span>
<span class="sd">                                             different.</span>



<span class="sd">        &gt;&gt;&gt; sound = Sound.from_sinwave(440, duration=3)</span>
<span class="sd">        &gt;&gt;&gt; a, b = sound[:1], sound[1:]</span>
<span class="sd">        &gt;&gt;&gt; a.concat(b) == sound</span>
<span class="sd">        True</span>

<span class="sd">        Recommend using :func:`concat&lt;gensound.sound.concat&gt;` function instead</span>
<span class="sd">        of this method if concatenate many sounds. Because</span>
<span class="sd">        :func:`concat&lt;gensound.sound.concat&gt;` function is optimized for many</span>
<span class="sd">        sounds.</span>

<span class="sd">        &gt;&gt;&gt; concat(a, b) == a.concat(b)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">another</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sound.overlay"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.overlay">[docs]</a>    <span class="k">def</span> <span class="nf">overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">another</span><span class="p">:</span> <span class="s1">&#39;Sound&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sound&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Create a new instance that was overlay another sound</span>

<span class="sd">        :param another: The sound that overlay.</span>

<span class="sd">        :return: A new :class:`Sound` that overlay another sound.</span>

<span class="sd">        :exception DifferentSamplerateError: The samplerate was different.</span>
<span class="sd">        :exception DifferentChannelsError:   The number of channels was</span>
<span class="sd">                                             different.</span>


<span class="sd">        &gt;&gt;&gt; a = Sound.from_array([0.1, 0.2], 1)</span>
<span class="sd">        &gt;&gt;&gt; b = Sound.from_array([0.1, 0.2, 0.3], 1)</span>
<span class="sd">        &gt;&gt;&gt; a.overlay(b) == Sound.from_array([0.2, 0.4, 0.3], 1)</span>
<span class="sd">        True</span>

<span class="sd">        Recommend using :func:`overlay&lt;gensound.sound.overlay&gt;` function</span>
<span class="sd">        instead of this method if overlay many sounds. Because</span>
<span class="sd">        :func:`overlay&lt;gensound.sound.overlay&gt;` function is optimized for many</span>
<span class="sd">        sounds.</span>

<span class="sd">        &gt;&gt;&gt; overlay(a, b) == a.overlay(b)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">another</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sound.write"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
              <span class="n">file_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">BinaryIO</span><span class="p">],</span>
              <span class="n">format_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Write sound into file or file-like</span>

<span class="sd">        :param file_:   A file name or file-like object to write sound.</span>
<span class="sd">        :param format_: Format type of output like a &#39;wav&#39;. Automatically</span>
<span class="sd">                        detect from file name if None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">soundfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">format_</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sound.play"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.Sound.play">[docs]</a>    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Play sound &quot;&quot;&quot;</span>

        <span class="k">class</span> <span class="nc">Callback</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

            <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">in_</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">frame_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                     <span class="n">time_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                     <span class="n">status</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>

                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">+</span> <span class="n">frame_count</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">+=</span> <span class="n">frame_count</span>

                <span class="n">flag</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="o">.</span><span class="n">paContinue</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="o">.</span><span class="n">paComplete</span>

                <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">flag</span>

        <span class="n">pa</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="o">.</span><span class="n">PyAudio</span><span class="p">()</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">pyaudio</span><span class="o">.</span><span class="n">paFloat32</span><span class="p">,</span>
                         <span class="n">channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">samplerate</span><span class="p">,</span>
                         <span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">stream_callback</span><span class="o">=</span><span class="n">Callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">)</span>

        <span class="n">stream</span><span class="o">.</span><span class="n">start_stream</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">stream</span><span class="o">.</span><span class="n">is_active</span><span class="p">():</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">stop_stream</span><span class="p">()</span>

        <span class="n">stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pa</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="concat"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.concat">[docs]</a><span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="o">*</span><span class="n">sounds</span><span class="p">:</span> <span class="n">Sound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sound</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Concatenate multiple sounds</span>

<span class="sd">    :param sounds: Sound instances to concatenate. Must they has some sampling</span>
<span class="sd">                   rate.</span>

<span class="sd">    :return: A concatenated :class:`Sound` instance.</span>

<span class="sd">    :exception DifferentSamplerateError: The samplerate of sounds was</span>
<span class="sd">                                         different.</span>
<span class="sd">    :exception DifferentChannelsError:   The number of channels of sounds was</span>
<span class="sd">                                         different.</span>


<span class="sd">    &gt;&gt;&gt; a = Sound.from_array([0.1, 0.2], 1)</span>
<span class="sd">    &gt;&gt;&gt; b = Sound.from_array([0.3, 0.4], 1)</span>
<span class="sd">    &gt;&gt;&gt; c = Sound.from_array([0.5, 0.6], 1)</span>
<span class="sd">    &gt;&gt;&gt; concat(a, b, c) == Sound.from_array([0.1, 0.2, 0.3, 0.4, 0.5, 0.6], 1)</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_assertSameSamplerate</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">samplerate</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">])</span>
    <span class="n">_assertSameChannels</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">n_channels</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">]),</span> <span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span></div>


<div class="viewcode-block" id="overlay"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.overlay">[docs]</a><span class="k">def</span> <span class="nf">overlay</span><span class="p">(</span><span class="o">*</span><span class="n">sounds</span><span class="p">:</span> <span class="n">Sound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sound</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Overlay multiple sounds</span>

<span class="sd">    :param sounds: Sound instances to overlay.</span>
<span class="sd">                   Must they has some sampling rate.</span>

<span class="sd">    :return: A new :class:`Sound` instance that overlay all sounds.</span>

<span class="sd">    :exception DifferentSamplerateError: The samplerate of sounds was</span>
<span class="sd">                                         different.</span>
<span class="sd">    :exception DifferentChannelsError:   The number of channels of sounds was</span>
<span class="sd">                                         different.</span>


<span class="sd">    BE CAREFUL: This function doesn&#39;t care about clipping. Perhaps, need to</span>
<span class="sd">                change volume before use this if overlay many sounds.</span>

<span class="sd">    &gt;&gt;&gt; a = Sound.from_array([0.1, 0.2], 1)</span>
<span class="sd">    &gt;&gt;&gt; b = Sound.from_array([0.3, 0.4], 1)</span>
<span class="sd">    &gt;&gt;&gt; c = Sound.from_array([0.5, 0.6], 1)</span>
<span class="sd">    &gt;&gt;&gt; overlay(a, b, c) == Sound.from_array([0.9, 1.0], 1)</span>
<span class="sd">    True</span>

<span class="sd">    The second element of this sample isn&#39;t 1.2 but 1.0 because of clipping was</span>
<span class="sd">    an occurrence.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_assertSameSamplerate</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">samplerate</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">])</span>
    <span class="n">_assertSameChannels</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">n_channels</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">])</span>

    <span class="n">longest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">)</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">longest</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">n_channels</span><span class="p">])])</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sounds</span>
    <span class="p">])</span>

    <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="n">padded</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span></div>


<div class="viewcode-block" id="merge_channels"><a class="viewcode-back" href="../../modules/sound.html#gensound.sound.merge_channels">[docs]</a><span class="k">def</span> <span class="nf">merge_channels</span><span class="p">(</span><span class="o">*</span><span class="n">sounds</span><span class="p">:</span> <span class="n">Sound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sound</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Merge multiple sounds as a sound that has multiple channels</span>

<span class="sd">    :param sounds: Sound instances to merge. Must they has some sampling rate.</span>

<span class="sd">    :return: A new :class:`Sound` that merged sounds as channels.</span>

<span class="sd">    :exception DifferentSamplerateError: The samplerate of sounds was</span>
<span class="sd">                                         different.</span>


<span class="sd">    BE CAREFUL: all sounds calculate as monaural sound.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_assertSameSamplerate</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">samplerate</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">])</span>

    <span class="n">longest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sounds</span><span class="p">)</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">as_monaural</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">longest</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">])])</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sounds</span>
    <span class="p">])</span>

    <span class="k">return</span> <span class="n">Sound</span><span class="p">(</span><span class="n">padded</span><span class="p">,</span> <span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">samplerate</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">PyGenSound</a></h1>



<p class="blurb">The python library for generating sound and compute.</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial-commandline.html">Commandline Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/index.html">Modules reference</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, MacRat.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    
    <a href="https://github.com/macrat/PyGenSound" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>